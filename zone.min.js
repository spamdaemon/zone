(function(){function y(a){var b,c,d,g,e;if(a.hasOwnProperty("value"))return a.value;if(!0===a.n)throw Error("Cyclic dependency detected with "+a.k);a.n=!0;if(a.c instanceof q)d=a.c.value;else{try{if(b=u(a.b,2,a.c,!1),null===b)throw Error("Failed to resolve "+a.k);}finally{delete a.n}try{d=b()}catch(k){throw Error("Failed to resolve "+a.k+"\n"+k.toString());}}b=a.b.i[a.name]||[];g=0;for(e=b.length;g<e;++g){c=b[g];c=u(c.b,2,c.c,!1);if(null===c)throw Error("Failed to resolve interceptor for "+a.name);
d=c()(d)}a.value=d;delete a.c;return a.value}function u(a,b,c,d){var g,e,k,f,n,h,l,m;l=c.f;m=c.d;k=c.isConstructor;f=[];n=[a];g=0;for(e=l.length;g<e;++g)if(h=l[g],"#"===h[0]){if(!d)throw Error("Free arguments are not allowed");f.push(n.length);n.push(void 0)}else if(c=!1,"?"===h[0]&&(c=!0,h=h.substr(1)),h=v(h,a,b,{}))c=y(h),n.push(c);else if(c)n.push(void 0);else return null;e=f.length;return function(){for(g=0;g<e;++g)n[f[g]]=arguments[g];var a=Function.prototype.bind.apply(m,n);return k?new a:a()}}
function v(a,b,c,d){var g,e,h,k,f;h=new w(a,b);a=h.b;h=h.e;a!==b&&(c=0);d=d||{};for(b=null;!b&&a;){a.m=!0;if((b=a.j[h])&&b.q(c))break;b=null;if(!b){if(!0===d[a.a])throw Error("Cyclic dependency : "+a.a);try{for(d[a.a]=!0,f=a.g||[],a.g=f,g=0,e=f.length;g<e&&!b;++g){k=r(f[g],!1);if(null===k)throw Error("Invalid dependency : "+f[g]);b=v(h,k,0,d)}}finally{d[a.a]=!1}c=1;a=a.o}}return b}function w(a,b){this.b=b;this.e=a;this.l=".";var c;c=a.lastIndexOf(".");0<=c&&(this.l=a.substring(0,c),this.b=r(this.l,
!1),this.e=a.substr(c+1))}function f(a,b,c,d){l(d,2);if(0===b.length||0<=b.indexOf("."))throw Error("Invalid name to bind "+b);if(a.j[b])throw Error("Name "+b+" already bound in "+a.a);if(a.m)throw Error("Module "+a.a+" is sealed");d=d instanceof q||d instanceof m?d:1!==d.length||"function"===typeof d[0]||d[0]instanceof m?h(d):p(d[0]);c=new z(a,b,c,d);a.j[b]=c;return a}function z(a,b,c,d){this.b=a;this.name=b;this.k=A(a.a,b);this.c=d;switch(c){case 0:case 2:case 1:this.p=c;break;default:throw Error("Invalid access "+
c);}}function s(a){a=h(a);a.isConstructor=!0;return a}function h(a){return a instanceof m?a:1===a.length&&a[0]instanceof m?a[0]:new m(a)}function p(a){return a instanceof q?a:new q(a)}function q(a){this.value=a}function D(a,b){this.b=a;this.c=b}function m(a){var b;if(1===a.length&&Array.isArray(a[0]))b=a[0].length,this.f=a[0].slice(0,b-1),this.d=a[0][b-1],B(this.f,this.d);else if(2===a.length)this.f=a[0].slice(),this.d=a[1],B(this.f,this.d);else if("function"===typeof a[0])this.d=a[0],this.f=C(this.d);
else throw Error("Invalid function description");}function B(a,b){if(C(b).length!==a.length)throw Error("Formals and parameter names do not match");}function r(a,b){var c=x[a],d,g,e,c=c||null;if(!c&&b)for(d=a.split(/\./),c=t,g=0,e=d.length;g<e;++g)c=c.create(d[g],null);return c}function e(a,b,c){this.h={};this.o=b;this.g=c;this.m=!1;this.j={};this.i={};this.a=a;if(b){if(b.h[a])throw Error("Module "+this.a+" already contains a module "+a);this.a=A(b.a,a);b.h[a]=this}x[this.a]=this}function C(a){if("function"!==
typeof a)throw Error("Not a function: "+a);var b=a.toString().match(/^\s*function\s*(?:\w*\s*)?\((.*?)\)/),b=b?b[1]?b[1].trim().split(/\s*,\s*/):[]:null;if(null===b)throw Error("Not a valid function "+a.toString());return b}function A(a,b){return""===a?b:a+"."+b}function l(a,b){k(a,1);if(!(a.length<=b))throw Error("Expected at most "+b+" arguments, but got "+a.length);}function k(a,b){if(!(a.length>=b))throw Error("Expected at least "+b+" arguments, but got "+a.length);}if(this.zone)return console.log("Zone already has been defined"),
this.zone;var x={},E=Array.isArray,t=new e("",null,[]);z.prototype.q=function(a){return this.p<=a};e.prototype.inject=function(a){var b=h(arguments),b=u(this,0,b,!0);if(null===b)throw Error("Failed to create injected function");return b};e.prototype.create=function(a,b){var c;if(0===a.length||0<=a.indexOf("."))throw Error("Invalid name "+a);if(b&&!E(b))throw Error("Imports are not an array");if(c=this.h[a]){if(b){if(c.g)throw Error("Module already has imports "+c.a);c.g=b}}else c=new e(a,this,b||
null);return c};e.prototype.get=function(a){var b=v(a,this,0,{});if(!b)throw Error("Not found "+a);return y(b)};e.prototype.definePrivate=function(a,b){k(arguments,2);return f(this,a,2,Array.prototype.slice.call(arguments,1))};e.prototype.defineProtected=function(a,b){k(arguments,2);return f(this,a,1,Array.prototype.slice.call(arguments,1))};e.prototype["export"]=function(a,b){k(arguments,2);return f(this,a,0,Array.prototype.slice.call(arguments,1))};e.prototype.factory=function(a,b){k(arguments,
2);var c=h(Array.prototype.slice.call(arguments,1));return f(this,a,2,[c])};e.prototype.protectedFactory=function(a,b){k(arguments,2);var c=h(Array.prototype.slice.call(arguments,1));return f(this,a,1,[c])};e.prototype.service=function(a,b){k(arguments,2);var c=s(Array.prototype.slice.call(arguments,1));return f(this,a,2,[c])};e.prototype.protectedService=function(a,b){k(arguments,2);var c=s(Array.prototype.slice.call(arguments,1));return f(this,a,1,[c])};e.prototype.interceptor=function(a,b){var c=
new w(a,this),d=c.b;null===d&&(d=r(c.l,!0));var e=h(Array.prototype.slice.call(arguments,1)),e=new D(this,e),f=d.i[c.e];f||(d.i[c.e]=f=[]);f.push(e);return this};e.prototype.value=function(a,b){k(arguments,2);return f(this,a,2,[p(b)])};e.prototype.protectedValue=function(a,b){k(arguments,2);return f(this,a,1,[p(b)])};e.prototype.exportFactory=function(a,b){k(arguments,2);var c=h(Array.prototype.slice.call(arguments,1));return f(this,a,0,[c])};e.prototype.exportService=function(a,b){k(arguments,2);
var c=s(Array.prototype.slice.call(arguments,1));return f(this,a,0,[c])};e.prototype.exportValue=function(a,b){k(arguments,2);return f(this,a,0,[p(b)])};this.zone=function(a,b){if(!a)return t;var c=r(a,!b);if(c)return c;throw Error("Module not found "+a);};this.zone.asFunction=function(a){l(arguments,2);return h(arguments)};this.zone.asConstructor=function(a){l(arguments,2);return s(arguments)};this.zone.asValue=function(a){l(arguments,1);return p(a)};this.zone.inject=function(a,b){l(arguments,3);
var c="",d=arguments;"string"===typeof arguments[0]&&(c=a,d=Array.prototype.slice.call(d,1));var e=h(d);return function(){return zone(c,!0).inject(e).apply(null,arguments)}};this.zone.get=function(a){l(arguments,1);var b=new w(a,t);if(null===b.b)throw Error("Not found "+a);return b.b.get(b.e)};this.zone.reset=function(){t=new e("",null,[]);x={}};return this.zone}).call(this);