(function(){if(this.zone)return console.log("Zone already has been defined"),this.zone;var y={},g=function(a,b){if(!(a.length>=b))throw Error("Expected at least "+b+" arguments, but got "+a.length);},q=function(a,b,c){g(a,b);if(!(a.length<=c))throw Error("Expected at most "+c+" arguments, but got "+a.length);},C=function(a,b){return""===a?b:a+"."+b},t=Array.isArray;t||(t=function(a){return 0<=a.length});var D=function(a){if("function"!==typeof a)throw Error("Not a function: "+a);a=a.toString();var b=
a.match(/^\s*function\s*(?:\w*\s*)?\(([\s\S]*?)\)/),b=b?b[1]?b[1].trim().split(/\s*,\s*/):[]:null;null===b&&console.log("Failed to parse the function (perhaps it is too long?) : "+a);return b},f=function(a,b,c){this.__children={};this.__parent=b;this.__imports=c;this.__sealed=!1;this.__values={};this.__interceptors={};this.__fullName=a;if(b){if(b.__children[a])throw Error("Module "+this.__fullName+" already contains a module "+a);this.__fullName=C(b.__fullName,a);b.__children[a]=this}y[this.__fullName]=
this},u=new f("",null,[]),I=function(a,b){if(a===b)return 2;for(;a&&a!==b;)a=a.__parent;return null===a?0:1},E=function(a){if(a.__sealed)throw Error("Module "+a.__fullName+" is sealed");},v=function(a,b){var c=y[a],d,e,s,c=c||null;if(!c&&b)for(d=a.split(/\./),c=u,e=0,s=d.length;e<s;++e)c=c.create(d[e],null);return c},F=function(a,b){var c=D(b);if(null!==c&&c.length!==a.length)throw Error("Formals and parameter names do not match");},p=function(a){var b;this.isConstructor=!1;if(1===a.length&&t(a[0]))b=
a[0].length,this.names=a[0].slice(0,b-1),this.func=a[0][b-1],F(this.names,this.func);else if(2===a.length)this.names=a[0].slice(),this.func=a[1],F(this.names,this.func);else if("function"===typeof a[0]){if(this.func=a[0],this.names=D(this.func),null===this.names)throw Error("Failed to determine function signature");}else throw Error("Invalid function description");};p.prototype.validateInjectionParameterNames=function(a,b){var c=this.names.length,d;for(d=0;d<c;++d){for(var e=this.names[d],s=a,f=b,
h=void 0,k=void 0,m=void 0,g=0,h=0,m=s.length;h<m;++h){k=e.indexOf(s[h]);if(0<k)throw Error("Invalid injection parameter "+e);if(0===k&&(++g,1<g))throw Error("Invalid injection parameter "+e);}h=0;for(m=f.length;h<m;++h)if(0<=e.indexOf(f[h]))throw Error("Invalid injection parameter "+e);}};var J=function(a,b){this.module=a;this.descriptor=b},w=function(a){this.value=a},r=function(a){return a instanceof w?a:new w(a)},n=function(a){return a instanceof p?a:1===a.length&&a[0]instanceof p?a[0]:new p(a)},
x=function(a){a=n(a);a.isConstructor=!0;return a},G=function(a,b,c,d){this.module=a;this.name=b;this.fullName=C(a.__fullName,b);this.descriptor=d;this.resolving=!1;switch(c){case 0:case 2:case 1:this.access=c;break;default:throw Error("Invalid access "+c);}};G.prototype.isAccessible=function(a){return this.access<=a};var l=function(a,b,c,d){q(d,1,2);if(0===b.length||0<=b.indexOf("."))throw Error("Invalid name to bind "+b);if(a.__values[b])throw Error("Name "+b+" already bound in "+a.__fullName);E(a);
d=d instanceof w||d instanceof p?d:1!==d.length||"function"===typeof d[0]||d[0]instanceof p?n(d):r(d[0]);d instanceof p&&d.validateInjectionParameterNames("?","#");c=new G(a,b,c,d);a.__values[b]=c;return a},z=function(a,b){this.module=b;this.local=a;this.modulePath=".";var c;c=a.lastIndexOf(".");0<=c&&(this.modulePath=a.substring(0,c),this.module=v(this.modulePath,!1),this.local=a.substr(c+1))},A=function(a,b,c,d){var e,f,g,h,k;g=new z(a,b);a=g.module;g=g.local;a!==b&&(c=Math.min(c,I(b,a)));d=d||
{};for(b=null;!b&&a;){a.__sealed=!0;if((b=a.__values[g])&&b.isAccessible(c))break;b=null;if(!b){if(!0===d[a.__fullName])throw Error("Cyclic dependency : "+a.__fullName);try{for(d[a.__fullName]=!0,k=a.__imports||[],a.__imports=k,e=0,f=k.length;e<f&&!b;++e){h=v(k[e],!1);if(null===h)throw Error("Invalid dependency : "+k[e]);b=A(g,h,0,d)}}finally{d[a.__fullName]=!1}c=1;a=a.__parent}}return b},B=function(a,b,c,d){var e,f,g,h,k,m,l,n,p,q;p=c.names;q=c.func;g=c.isConstructor;h=[];k=[a];e=0;for(f=p.length;e<
f;++e)if(m=p[e],"#"===m[0]){if(!d)throw Error("Free arguments are not allowed");h.push(k.length);k.push(void 0)}else if(n=!1,"?"===m[0]&&(n=!0,m=m.substr(1)),c=A(m,a,b,{})){try{l=H(c)}catch(r){throw console.log("Injection failed: "+m),r;}k.push(l)}else if(n)k.push(void 0);else return console.log("Injectable not found: "+m),null;f=h.length;return function(){for(e=0;e<f;++e)k[h[e]]=arguments[e];var a=Function.prototype.bind.apply(q,k);return g?new a:a()}},H=function(a){var b,c,d,e,f,g;if(a.hasOwnProperty("value"))return a.value;
if(!0===a.resolving)throw Error("Cyclic dependency detected with "+a.fullName);a.resolving=!0;if(a.descriptor instanceof w)e=a.descriptor.value;else{try{try{b=B(a.module,2,a.descriptor,!1)}catch(h){throw console.log("Failed to resolve "+a.fullName),h;}if(null===b)throw console.log("Failed to resolve "+a.fullName),Error("Failed to resolve "+a.fullName);}finally{a.resolving=!1}try{e=b()}catch(k){throw Error("Failed to resolve "+a.fullName+"\n"+k.toString());}}b=a.module.__interceptors[a.name]||[];f=
0;for(g=b.length;f<g;++f){c=b[f];try{d=B(c.module,2,c.descriptor,!1)}catch(l){throw console.log("Interceptor for "+a.fullName+" failed"),l;}if(null===d)throw Error("Failed to resolve interceptor for "+a.name);e=d()(e)}a.value=e;delete a.descriptor;return a.value};f.prototype.inject=function(a){var b=n(arguments);b.validateInjectionParameterNames("#?","");b=B(this,0,b,!0);if(null===b)throw Error("Failed to create injected function");return b};f.prototype.create=function(a){var b;if(0===a.length||0<=
a.indexOf("."))throw Error("Invalid name "+a);(b=this.__children[a])||(b=new f(a,this,null));return b};f.prototype.configure=function(a){if(!t(a))throw Error("Imports are not an array");if(this.__imports)throw Error("Module has already been configured "+this.__fullName);E(this);this.__imports=a.slice();return this};f.prototype.get=function(a){var b=A(a,this,0,{});if(b)return H(b);throw Error("Not found "+a);};f.prototype.definePrivate=function(a,b){g(arguments,2);return l(this,a,2,Array.prototype.slice.call(arguments,
1))};f.prototype.defineProtected=function(a,b){g(arguments,2);return l(this,a,1,Array.prototype.slice.call(arguments,1))};f.prototype["export"]=function(a,b){g(arguments,2);return l(this,a,0,Array.prototype.slice.call(arguments,1))};f.prototype.factory=function(a,b){g(arguments,2);var c=n(Array.prototype.slice.call(arguments,1));return l(this,a,2,[c])};f.prototype.protectedFactory=function(a,b){g(arguments,2);var c=n(Array.prototype.slice.call(arguments,1));return l(this,a,1,[c])};f.prototype.service=
function(a,b){g(arguments,2);var c=x(Array.prototype.slice.call(arguments,1));return l(this,a,2,[c])};f.prototype.protectedService=function(a,b){g(arguments,2);var c=x(Array.prototype.slice.call(arguments,1));return l(this,a,1,[c])};f.prototype.interceptor=function(a,b){var c=new z(a,this),d=c.module;null===d&&(d=v(c.modulePath,!0));var e=Array.prototype.slice.call(arguments,1),e=n(e);e.validateInjectionParameterNames("?","#");var e=new J(this,e),f=d.__interceptors[c.local];f||(d.__interceptors[c.local]=
f=[]);f.push(e);return this};f.prototype.value=function(a,b){g(arguments,2);var c=r(b);return l(this,a,2,[c])};f.prototype.protectedValue=function(a,b){g(arguments,2);var c=r(b);return l(this,a,1,[c])};f.prototype.exportFactory=function(a,b){g(arguments,2);var c=n(Array.prototype.slice.call(arguments,1));return l(this,a,0,[c])};f.prototype.exportService=function(a,b){g(arguments,2);var c=x(Array.prototype.slice.call(arguments,1));return l(this,a,0,[c])};f.prototype.exportValue=function(a,b){g(arguments,
2);var c=r(b);return l(this,a,0,[c])};this.zone=function(a,b){if(!a)return u;var c=v(a,!b);if(c)return c;throw Error("Module not found "+a);};this.zone.asFunction=function(a){q(arguments,1,2);return n(arguments)};this.zone.asConstructor=function(a){q(arguments,1,2);return x(arguments)};this.zone.asValue=function(a){q(arguments,1,1);return r(a)};this.zone.inject=function(a,b){q(arguments,1,3);var c="",d=arguments;"string"===typeof arguments[0]&&(c=a,d=Array.prototype.slice.call(d,1));var e=n(d);return function(){return zone(c,
!0).inject(e).apply(null,arguments)}};this.zone.get=function(a){q(arguments,1,1);var b=new z(a,u);if(null===b.module)throw Error("Not found "+a);return b.module.get(b.local)};this.zone.reset=function(){u=new f("",null,[]);y={}};this.zone.version=function(){return"1.0"};return this.zone}).call(this);
