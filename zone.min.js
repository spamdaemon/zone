(function(){function z(a){var b,c,e,h,d,g;if(a.hasOwnProperty("value"))return a.value;if(!0===a.o)throw Error("Cyclic dependency detected with "+a.d);a.o=!0;if(a.c instanceof r)h=a.c.value;else{try{try{b=v(a.b,2,a.c,!1)}catch(f){throw console.log("Failed to resolve "+a.d),f;}if(null===b)throw console.log("Failed to resolve "+a.d),Error("Failed to resolve "+a.d);}finally{delete a.o}try{h=b()}catch(k){throw Error("Failed to resolve "+a.d+"\n"+k.toString());}}b=a.b.j[a.name]||[];d=0;for(g=b.length;d<
g;++d){c=b[d];try{e=v(c.b,2,c.c,!1)}catch(m){throw console.log("Interceptor for "+a.d+" failed"),m;}if(null===e)throw Error("Failed to resolve interceptor for "+a.name);h=e()(h)}a.value=h;delete a.c;return a.value}function v(a,b,c,e){var h,d,g,f,k,m,l,n,p,q;p=c.f;q=c.e;g=c.isConstructor;f=[];k=[a];h=0;for(d=p.length;h<d;++h)if(m=p[h],"#"===m[0]){if(!e)throw Error("Free arguments are not allowed");f.push(k.length);k.push(void 0)}else if(n=!1,"?"===m[0]&&(n=!0,m=m.substr(1)),c=w(m,a,b,{})){try{l=z(c)}catch(r){throw console.log("Injection failed: "+
m),r;}k.push(l)}else if(n)k.push(void 0);else return console.log("Injectable not found: "+m),null;d=f.length;return function(){for(h=0;h<d;++h)k[f[h]]=arguments[h];var a=Function.prototype.bind.apply(q,k);return g?new a:a()}}function w(a,b,c,e){var h,d,f,g,k;f=new x(a,b);a=f.b;f=f.g;if(a!==b){if(b===a)b=2;else{for(;b&&b!==a;)b=b.m;b=null===b?0:1}c=Math.min(c,b)}e=e||{};for(b=null;!b&&a;){a.n=!0;if((b=a.k[f])&&b.q(c))break;b=null;if(!b){if(!0===e[a.a])throw Error("Cyclic dependency : "+a.a);try{for(e[a.a]=
!0,k=a.h||[],a.h=k,h=0,d=k.length;h<d&&!b;++h){g=s(k[h],!1);if(null===g)throw Error("Invalid dependency : "+k[h]);b=w(f,g,0,e)}}finally{e[a.a]=!1}c=1;a=a.m}}return b}function x(a,b){this.b=b;this.g=a;this.l=".";var c;c=a.lastIndexOf(".");0<=c&&(this.l=a.substring(0,c),this.b=s(this.l,!1),this.g=a.substr(c+1))}function f(a,b,c,e){n(e,2);if(0===b.length||0<=b.indexOf("."))throw Error("Invalid name to bind "+b);if(a.k[b])throw Error("Name "+b+" already bound in "+a.a);if(a.n)throw Error("Module "+a.a+
" is sealed");e=e instanceof r||e instanceof p?e:1!==e.length||"function"===typeof e[0]||e[0]instanceof p?l(e):q(e[0]);c=new A(a,b,c,e);a.k[b]=c;return a}function A(a,b,c,e){this.b=a;this.name=b;this.d=B(a.a,b);this.c=e;switch(c){case 0:case 2:case 1:this.p=c;break;default:throw Error("Invalid access "+c);}}function t(a){a=l(a);a.isConstructor=!0;return a}function l(a){return a instanceof p?a:1===a.length&&a[0]instanceof p?a[0]:new p(a)}function q(a){return a instanceof r?a:new r(a)}function r(a){this.value=
a}function E(a,b){this.b=a;this.c=b}function p(a){var b;if(1===a.length&&Array.isArray(a[0]))b=a[0].length,this.f=a[0].slice(0,b-1),this.e=a[0][b-1],C(this.f,this.e);else if(2===a.length)this.f=a[0].slice(),this.e=a[1],C(this.f,this.e);else if("function"===typeof a[0]){if(this.e=a[0],this.f=D(this.e),null===this.f)throw Error("Failed to determine function signature");}else throw Error("Invalid function description");}function C(a,b){var c=D(b);if(null!==c&&c.length!==a.length)throw Error("Formals and parameter names do not match");
}function s(a,b){var c=y[a],e,d,f,c=c||null;if(!c&&b)for(e=a.split(/\./),c=u,d=0,f=e.length;d<f;++d)c=c.create(e[d],null);return c}function d(a,b,c){this.i={};this.m=b;this.h=c;this.n=!1;this.k={};this.j={};this.a=a;if(b){if(b.i[a])throw Error("Module "+this.a+" already contains a module "+a);this.a=B(b.a,a);b.i[a]=this}y[this.a]=this}function D(a){if("function"!==typeof a)throw Error("Not a function: "+a);a=a.toString();var b=a.match(/^\s*function\s*(?:\w*\s*)?\(([\s\S]*?)\)/),b=b?b[1]?b[1].trim().split(/\s*,\s*/):
[]:null;null===b&&console.log("Failed to parse the function (perhaps it is too long?) : "+a);return b}function B(a,b){return""===a?b:a+"."+b}function n(a,b){g(a,1);if(!(a.length<=b))throw Error("Expected at most "+b+" arguments, but got "+a.length);}function g(a,b){if(!(a.length>=b))throw Error("Expected at least "+b+" arguments, but got "+a.length);}if(this.zone)return console.log("Zone already has been defined"),this.zone;var y={},F=Array.isArray,u=new d("",null,[]);A.prototype.q=function(a){return this.p<=
a};d.prototype.inject=function(a){var b=l(arguments),b=v(this,0,b,!0);if(null===b)throw Error("Failed to create injected function");return b};d.prototype.create=function(a,b){var c;if(0===a.length||0<=a.indexOf("."))throw Error("Invalid name "+a);if(b&&!F(b))throw Error("Imports are not an array");if(c=this.i[a]){if(b){if(c.h)throw Error("Module already has imports "+c.a);c.h=b}}else c=new d(a,this,b||null);return c};d.prototype.get=function(a){var b=w(a,this,0,{});if(!b)throw Error("Not found "+
a);return z(b)};d.prototype.definePrivate=function(a,b){g(arguments,2);return f(this,a,2,Array.prototype.slice.call(arguments,1))};d.prototype.defineProtected=function(a,b){g(arguments,2);return f(this,a,1,Array.prototype.slice.call(arguments,1))};d.prototype["export"]=function(a,b){g(arguments,2);return f(this,a,0,Array.prototype.slice.call(arguments,1))};d.prototype.factory=function(a,b){g(arguments,2);var c=l(Array.prototype.slice.call(arguments,1));return f(this,a,2,[c])};d.prototype.protectedFactory=
function(a,b){g(arguments,2);var c=l(Array.prototype.slice.call(arguments,1));return f(this,a,1,[c])};d.prototype.service=function(a,b){g(arguments,2);var c=t(Array.prototype.slice.call(arguments,1));return f(this,a,2,[c])};d.prototype.protectedService=function(a,b){g(arguments,2);var c=t(Array.prototype.slice.call(arguments,1));return f(this,a,1,[c])};d.prototype.interceptor=function(a,b){var c=new x(a,this),e=c.b;null===e&&(e=s(c.l,!0));var d=l(Array.prototype.slice.call(arguments,1)),d=new E(this,
d),f=e.j[c.g];f||(e.j[c.g]=f=[]);f.push(d);return this};d.prototype.value=function(a,b){g(arguments,2);return f(this,a,2,[q(b)])};d.prototype.protectedValue=function(a,b){g(arguments,2);return f(this,a,1,[q(b)])};d.prototype.exportFactory=function(a,b){g(arguments,2);var c=l(Array.prototype.slice.call(arguments,1));return f(this,a,0,[c])};d.prototype.exportService=function(a,b){g(arguments,2);var c=t(Array.prototype.slice.call(arguments,1));return f(this,a,0,[c])};d.prototype.exportValue=function(a,
b){g(arguments,2);return f(this,a,0,[q(b)])};this.zone=function(a,b){if(!a)return u;var c=s(a,!b);if(c)return c;throw Error("Module not found "+a);};this.zone.asFunction=function(a){n(arguments,2);return l(arguments)};this.zone.asConstructor=function(a){n(arguments,2);return t(arguments)};this.zone.asValue=function(a){n(arguments,1);return q(a)};this.zone.inject=function(a,b){n(arguments,3);var c="",d=arguments;"string"===typeof arguments[0]&&(c=a,d=Array.prototype.slice.call(d,1));var f=l(d);return function(){return zone(c,
!0).inject(f).apply(null,arguments)}};this.zone.get=function(a){n(arguments,1);var b=new x(a,u);if(null===b.b)throw Error("Not found "+a);return b.b.get(b.g)};this.zone.reset=function(){u=new d("",null,[]);y={}};return this.zone}).call(this);